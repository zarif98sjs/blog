<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>LightOj 1170 (Counting Perfect BST) :: zarif98sjs — zarif98sjs</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Idea  Binary Search / Catalan Number
 If there are n prefect power numbers in [a,b] , Answer is basically Catalan(n) Catalan(n) = (2n)! / (n! *(n&#43;1)!)  Proof   Consider all possible binary search trees with each element at the root. If there are n nodes, then for each choice of root node, there are n – 1 non-root nodes and these non-root nodes must be partitioned into those that are less than a chosen root and those that are greater than the chosen root." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://zarif98sjs.github.io/blog/blog/lightoj1170/" />




<link rel="stylesheet" href="https://zarif98sjs.github.io/blog/assets/style.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://zarif98sjs.github.io/blog/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://zarif98sjs.github.io/blog/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />

  <meta name="twitter:site" content="" />

<meta name="twitter:creator" content="~5 min read" />


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="LightOj 1170 (Counting Perfect BST) :: zarif98sjs">
<meta property="og:description" content="Counting Perfect BST" />
<meta property="og:url" content="https://zarif98sjs.github.io/blog/blog/lightoj1170/" />
<meta property="og:site_name" content="LightOj 1170 (Counting Perfect BST)" />

  
    <meta property="og:image" content="https://zarif98sjs.github.io/blog/img/favicon/orange.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2020-05-06 00:00:00 &#43;0000 UTC" />












</head>
<body class="">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="https://zarif98sjs.github.io/">
  <div class="logo">
    zarif98sjs
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://zarif98sjs.github.io/about/">About</a></li>
        
      
        
          <li><a href="https://zarif98sjs.github.io/projects/">Projects</a></li>
        
      
        
          <li><a href="https://zarif98sjs.github.io/skills/">Skills</a></li>
        
      
        
          <li><a href="/blog/memento/">Memento</a></li>
        
      
        
          <li><a href="/blog/blog">Blog</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://zarif98sjs.github.io/about/">About</a></li>
      
    
      
        <li><a href="https://zarif98sjs.github.io/projects/">Projects</a></li>
      
    
      
        <li><a href="https://zarif98sjs.github.io/skills/">Skills</a></li>
      
    
      
        <li><a href="/blog/memento/">Memento</a></li>
      
    
      
        <li><a href="/blog/blog">Blog</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://zarif98sjs.github.io/blog/blog/lightoj1170/">LightOj 1170 (Counting Perfect BST)</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2020-05-06
    </span>
    
    
    <span class="post-author">::
      ~5 min read
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://zarif98sjs.github.io/blog/tags/lightoj/">lightoj</a>&nbsp;
    
    #<a href="https://zarif98sjs.github.io/blog/tags/cp/">cp</a>&nbsp;
    
    #<a href="https://zarif98sjs.github.io/blog/tags/problem-solving/">problem solving</a>&nbsp;
    
    #<a href="https://zarif98sjs.github.io/blog/tags/binary-search/">binary search</a>&nbsp;
    
  </span>
  

  

  <div class="post-content"><div>
        <h1 id="idea">Idea<a href="#idea" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<hr>
<p>Binary Search / Catalan Number</p>
<ul>
<li>If there are n prefect power numbers in [a,b] , Answer is basically Catalan(n)</li>
<li>Catalan(n) = <code>(2n)! / (n! *(n+1)!)</code></li>
</ul>
<h1 id="proof">Proof<a href="#proof" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<hr>
<ul>
<li>Consider all possible binary search trees with each element at the root.
If there are n nodes, then for each choice of root node, there are n – 1 non-root nodes and these non-root nodes must be partitioned into those that are less than a chosen root and those that are greater than the chosen root.</li>
<li>Let’s say node i is chosen to be the root. Then there are i – 1 nodes smaller than i and n – i nodes bigger than i. For each of these two sets of nodes, there is a certain number of possible subtrees.</li>
<li>Let T(n) be the total number of BSTs with n nodes. The total number of BSTs with i at the root is T(i – 1) * T(n – i). The two terms are multiplied together because the arrangements in the left and right subtrees are independent. That is, for each arrangement in the left tree and for each arrangement in the right tree, you get one BST with i at the root.</li>
<li>Summing over i gives the total number of binary search trees with n nodes.<br>
T(n) = Summation(i = 1 to n) [T(i – 1) * T(n – i)]</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">
<span style="color:#75715e">/** Which of the favors of your Lord will you deny ? **/</span>

<span style="color:#75715e">#include</span><span style="color:#75715e">&lt;bits/stdc++.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;

<span style="color:#75715e">#define LL long long
</span><span style="color:#75715e">#define PII pair&lt;int,int&gt;
</span><span style="color:#75715e">#define PLL pair&lt;LL,LL&gt;
</span><span style="color:#75715e">#define MP make_pair
</span><span style="color:#75715e">#define F first
</span><span style="color:#75715e">#define S second
</span><span style="color:#75715e">#define INF INT_MAX
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#define ALL(x) (x).begin(), (x).end()
</span><span style="color:#75715e">#define DBG(x) cerr &lt;&lt; __LINE__ &lt;&lt; &#34; says: &#34; &lt;&lt; #x &lt;&lt; &#34; = &#34; &lt;&lt; (x) &lt;&lt; endl
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;ext/pb_ds/assoc_container.hpp&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;ext/pb_ds/tree_policy.hpp&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> __gnu_pbds;

<span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TIn</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">using</span> indexed_set <span style="color:#f92672">=</span> tree<span style="color:#f92672">&lt;</span>TIn, null_type, less<span style="color:#f92672">&lt;</span>TIn<span style="color:#f92672">&gt;</span>,rb_tree_tag, tree_order_statistics_node_update<span style="color:#f92672">&gt;</span>;

<span style="color:#75715e">/**
</span><span style="color:#75715e">PBDS
</span><span style="color:#75715e">-------------------------------------------------
</span><span style="color:#75715e">1) insert(value)
</span><span style="color:#75715e">2) erase(value)
</span><span style="color:#75715e">3) order_of_key(value) // 0 based indexing
</span><span style="color:#75715e">4) *find_by_order(position) // 0 based indexing
</span><span style="color:#75715e">**/</span>

<span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T1</span>, <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T2</span><span style="color:#f92672">&gt;</span>
ostream <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;&lt;</span>(ostream <span style="color:#f92672">&amp;</span>os, pair<span style="color:#f92672">&lt;</span>T1,T2<span style="color:#f92672">&gt;&amp;</span>p);
<span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T</span><span style="color:#f92672">&gt;</span>
ostream <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;&lt;</span>(ostream <span style="color:#f92672">&amp;</span>os, vector<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;&amp;</span>v);
<span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T</span><span style="color:#f92672">&gt;</span>
ostream <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;&lt;</span>(ostream <span style="color:#f92672">&amp;</span>os, set<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;&amp;</span>v);

<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">optimizeIO</span>()
{
    ios_base<span style="color:#f92672">::</span>sync_with_stdio(false);
    cin.tie(NULL);
}

<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> nmax <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e6</span><span style="color:#f92672">+</span><span style="color:#ae81ff">7</span>;
<span style="color:#66d9ef">const</span> LL LINF <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e17</span>;

string <span style="color:#a6e22e">to_str</span>(LL x)
{
    stringstream ss;
    ss<span style="color:#f92672">&lt;&lt;</span>x;
    <span style="color:#66d9ef">return</span> ss.str();
}

<span style="color:#75715e">//bool cmp(const PII &amp;A,const PII &amp;B)
</span><span style="color:#75715e">//{
</span><span style="color:#75715e">//
</span><span style="color:#75715e">//}
</span><span style="color:#75715e"></span>

set<span style="color:#f92672">&lt;</span>LL<span style="color:#f92672">&gt;</span>SET;
vector<span style="color:#f92672">&lt;</span>LL<span style="color:#f92672">&gt;</span>v;
LL facto[nmax];
LL mod <span style="color:#f92672">=</span> <span style="color:#ae81ff">100000007</span>;

<span style="color:#75715e">// ax + by = GCD(a,b)
</span><span style="color:#75715e">// r2 is GCD(a,b) and X &amp; Y will be the co-eff of a and b respectively
</span><span style="color:#75715e"></span>LL <span style="color:#a6e22e">ext_gcd</span> ( LL A, LL B, LL <span style="color:#f92672">&amp;</span>X, LL <span style="color:#f92672">&amp;</span>Y )
{
    LL x2, y2, x1, y1, x, y, r2, r1, q, r;
    x2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    y2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    x1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    y1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">for</span> (r2 <span style="color:#f92672">=</span> A, r1 <span style="color:#f92672">=</span> B; r1 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>; r2 <span style="color:#f92672">=</span> r1, r1 <span style="color:#f92672">=</span> r, x2 <span style="color:#f92672">=</span> x1, y2 <span style="color:#f92672">=</span> y1, x1 <span style="color:#f92672">=</span> x, y1 <span style="color:#f92672">=</span> y )
    {
        q <span style="color:#f92672">=</span> r2 <span style="color:#f92672">/</span> r1;
        r <span style="color:#f92672">=</span> r2 <span style="color:#f92672">%</span> r1;
        x <span style="color:#f92672">=</span> x2 <span style="color:#f92672">-</span> (q <span style="color:#f92672">*</span> x1);
        y <span style="color:#f92672">=</span> y2 <span style="color:#f92672">-</span> (q <span style="color:#f92672">*</span> y1);
    }
    X <span style="color:#f92672">=</span> x2;
    Y <span style="color:#f92672">=</span> y2;
    <span style="color:#66d9ef">return</span> r2;
}

<span style="color:#75715e">//when inverse of a (w.r.to mo) &amp;&amp; mo is not prime
</span><span style="color:#75715e"></span>LL <span style="color:#a6e22e">modInv_general</span> ( LL a, LL m ) {
    LL x, y;
    ext_gcd( a, m, x, y );

    <span style="color:#75715e">// Process x so that it is between 0 and m-1
</span><span style="color:#75715e"></span>    x <span style="color:#f92672">%=</span> m;
    <span style="color:#66d9ef">if</span> ( x <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> ) x <span style="color:#f92672">+=</span> m;
    <span style="color:#66d9ef">return</span> x;
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">precalc1</span>()
{
    LL lim <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e10</span>;

    <span style="color:#66d9ef">for</span>(LL i<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>; i<span style="color:#f92672">*</span>i<span style="color:#f92672">&lt;=</span>lim; i<span style="color:#f92672">++</span>)
    {
        LL val <span style="color:#f92672">=</span> i;

        <span style="color:#66d9ef">for</span>(LL j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; val<span style="color:#f92672">&lt;=</span>lim; j<span style="color:#f92672">++</span>)
        {
            val <span style="color:#f92672">*=</span> i;

            <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>SET.count(val))
            {
                SET.insert(val);
                v.push_back(val);
            }
        }
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">precalc2</span>()
{
    <span style="color:#75715e">/** SET size is around 2e5 **/</span>

    LL lim <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e6</span>;

    facto[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;

    <span style="color:#66d9ef">for</span>(LL i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; i<span style="color:#f92672">&lt;=</span>lim; i<span style="color:#f92672">++</span>)
    {
        facto[i]<span style="color:#f92672">=</span>((facto[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">%</span>mod)<span style="color:#f92672">*</span>(i<span style="color:#f92672">%</span>mod))<span style="color:#f92672">%</span>mod; <span style="color:#75715e">//(facto[i-1]*i)%m
</span><span style="color:#75715e"></span>    }
}

LL <span style="color:#a6e22e">catalan</span>(LL n)
{
    <span style="color:#66d9ef">if</span>(n<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;

    LL ans1 <span style="color:#f92672">=</span> facto[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n];
    LL v1 <span style="color:#f92672">=</span> facto[n];
    LL v2 <span style="color:#f92672">=</span> facto[n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];

    LL ans2 <span style="color:#f92672">=</span> modInv_general(v1,mod);
    LL ans3 <span style="color:#f92672">=</span> modInv_general(v2,mod);

    LL ans <span style="color:#f92672">=</span> (ans1<span style="color:#f92672">*</span>ans2)<span style="color:#f92672">%</span>mod;
    ans <span style="color:#f92672">=</span> (ans<span style="color:#f92672">*</span>ans3)<span style="color:#f92672">%</span>mod;

    <span style="color:#66d9ef">return</span> ans;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
    <span style="color:#75715e">//freopen(&#34;out.txt&#34;,&#34;w&#34;,stdout);
</span><span style="color:#75715e"></span>
    optimizeIO();

    precalc1();
    precalc2();

    sort(ALL(v));

    <span style="color:#66d9ef">int</span> tc;
    cin<span style="color:#f92672">&gt;&gt;</span>tc;

    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> q<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; q<span style="color:#f92672">&lt;=</span>tc; q<span style="color:#f92672">++</span>)
    {
        LL a,b;
        cin<span style="color:#f92672">&gt;&gt;</span>a<span style="color:#f92672">&gt;&gt;</span>b;

        LL ca <span style="color:#f92672">=</span> upper_bound(ALL(v),a<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">-</span>v.begin();
        LL cb <span style="color:#f92672">=</span> upper_bound(ALL(v),b)<span style="color:#f92672">-</span>v.begin();

        LL n <span style="color:#f92672">=</span> cb<span style="color:#f92672">-</span>ca;

        LL ans <span style="color:#f92672">=</span> catalan(n);

        cout<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;Case &#34;</span><span style="color:#f92672">&lt;&lt;</span>q<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;: &#34;</span>;
        cout<span style="color:#f92672">&lt;&lt;</span>ans<span style="color:#f92672">&lt;&lt;</span>endl;
    }

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}

<span style="color:#75715e">/**
</span><span style="color:#75715e">4
</span><span style="color:#75715e">1 4
</span><span style="color:#75715e">5 10
</span><span style="color:#75715e">1 10
</span><span style="color:#75715e">1 3
</span><span style="color:#75715e">**/</span>

<span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T1</span>, <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T2</span><span style="color:#f92672">&gt;</span>
ostream <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;&lt;</span>(ostream <span style="color:#f92672">&amp;</span>os, pair<span style="color:#f92672">&lt;</span>T1,T2<span style="color:#f92672">&gt;&amp;</span>p)
{
    os<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;{&#34;</span><span style="color:#f92672">&lt;&lt;</span>p.first<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;, &#34;</span><span style="color:#f92672">&lt;&lt;</span>p.second<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;} &#34;</span>;
    <span style="color:#66d9ef">return</span> os;
}
<span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T</span><span style="color:#f92672">&gt;</span>
ostream <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;&lt;</span>(ostream <span style="color:#f92672">&amp;</span>os, vector<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;&amp;</span>v)
{
    os<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;[ &#34;</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span>v.size(); i<span style="color:#f92672">++</span>)
    {
        os<span style="color:#f92672">&lt;&lt;</span>v[i]<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34; &#34;</span> ;
    }
    os<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34; ]&#34;</span>;
    <span style="color:#66d9ef">return</span> os;
}

<span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T</span><span style="color:#f92672">&gt;</span>
ostream <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;&lt;</span>(ostream <span style="color:#f92672">&amp;</span>os, set<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;&amp;</span>v)
{
    os<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34;[ &#34;</span>;
    <span style="color:#66d9ef">for</span>(T i:v)
    {
        os<span style="color:#f92672">&lt;&lt;</span>i<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34; &#34;</span>;
    }
    os<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#34; ]&#34;</span>;
    <span style="color:#66d9ef">return</span> os;
}

</code></pre></div>
      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://zarif98sjs.github.io/blog/blog/lightoj1235/">
                <span class="button__icon">←</span>
                <span class="button__text">LightOj 1235 (Coin Change IV)</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://zarif98sjs.github.io/blog/blog/lightoj1048/">
                <span class="button__text">LightOj 1048 (Conquering Keokradong)</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  




</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span> Md. Zarif Ul ALam © 2020 </span>
    
        
      </div>
  </div>
</footer>

<script src="https://zarif98sjs.github.io/blog/assets/main.js"></script>
<script src="https://zarif98sjs.github.io/blog/assets/prism.js"></script>





<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  
</div>

</body>
</html>
